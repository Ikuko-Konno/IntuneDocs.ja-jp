---
title: Microsoft Intune に Win32 アプリを追加する titlesuffix: description: Microsoft Intune を使用して Win32 アプリを追加、配信、および管理する方法について説明します。 このトピックでは、Win32 アプリを配信および管理する Intune の機能の概要と、Win32 アプリのトラブルシューティング情報について説明します。 keywords: author: Erikre ms.author: erikre manager: dougeby <<<<<<< HEAD ms.date: 10/23/2018 ======= ms.date: 10/19/2018
>>>>>>> 14fdd9aac5e66324acfe83ae31b126d8216d7da4 ms.topic: article ms.prod: ms.service: microsoft-intune ms.technology: ms.assetid: efdc196b-38f3-4678-ae16-cdec4303f8d2

ms.reviewer: mghadial ms.suite: ems ms.custom: intune-azure
---

# <a name="intune-standalone---win32-app-management-public-preview"></a>Intune スタンドアロン - Win32 アプリの管理 (パブリック プレビュー)

Intune スタンドアロンでは、Win32 アプリの管理機能が向上します。 クラウドに接続された顧客が Win32 アプリの管理用に Configuration Manager を使用することはできますが、Intune 限定の顧客の方が、Win32 基幹業務 (LOB) アプリに対してより優れた管理機能を利用できます。 このトピックでは、Win32 アプリを管理する Intune の機能の概要と、トラブルシューティング情報について説明します。

## <a name="prerequisites-for-public-preview"></a>パブリック プレビューの前提条件

- Windows 10 バージョン 1607 以降 (Enterprise)
- Windows 10 クライアントは次の状態である必要があります 
    - Azure Active Directory (AAD) またはハイブリッド Azure Active Directory に参加している
    - Intune に登録されている (MDM 管理対象)
- パブリック プレビューでは、Windows アプリケーションのサイズはアプリごとに 8 GB に制限されています 

> [!NOTE]
> 現在、Windows 10 バージョン 1607 の Pro と Education の各エディションのテストを実施しており、ご意見をお待ちしています。


## <a name="prepare-the-win32-app-content-for-upload"></a>Win32 アプリ コンテンツのアップロードを準備する

[Microsoft Intune Win32 アプリのアップロード準備ツール](https://github.com/Microsoft/Intune-Win32-App-Packaging-Tool)を使用して、Win32 アプリを事前処理します。 パッケージ化ツールは、アプリケーション インストール ファイルを *.intunewin* 形式に変換します。 また、パッケージ化ツールは、Intune でアプリケーションのインストール状態を判断するのに必要な属性の一部を検出します。 アプリのインストーラー フォルダーでこのツールを使用した後、Intune コンソールで Win32 アプリを作成できます。

[Microsoft Intune Win32 アプリのアップロード準備ツール](https://github.com/Microsoft/Intune-Win32-App-Packaging-Tool)は GitHub からダウンロードできます。

### <a name="available-command-line-parameters"></a>使用可能なコマンド ライン パラメーター 

|    **コマンド ライン パラメーター**    |    **説明**    |
|:------------------------------:|:----------------------------------------------------------:|
|    `-h`     |    ヘルプ    |
|    `-c <setup_folder>`     |    すべてのセットアップ ファイルのセットアップ フォルダー。    |
|   ` -s <setup_file>`     |    セットアップ ファイル (*setup.exe*、*setup.msi* など)。    |
|    `-o <output_folder>`     |    生成された *.intunewin* ファイルの出力フォルダー。    |
|    `-q`       |    Quiet モード。    |

### <a name="example-commands"></a>コマンド例

|    **コマンド例**    |    **説明**    |
|:-----------------------------------------------------------------------------------------:|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------:|
|    `IntuneWinAppUtil -h`    |    このコマンドでは、ツールの使用情報が表示されます。    |
|    `IntuneWinAppUtil -c <setup_folder> -s <source_setup_file> -o <output_folder> <-q>`    |    このコマンドは、指定されたソース フォルダーおよびセットアップ ファイルから `.intunewin` ファイルを生成します。 MSI セットアップ ファイルでは、このツールは Intune に必要な情報を取得します。 `-q` が指定されている場合、コマンドは Quiet モードで実行され、出力ファイルが既に存在する場合は上書きされます。 また、出力フォルダーが存在しない場合は、自動的に作成されます。    |

## <a name="create-assign-and-monitor-a-win32-app"></a>Win32 アプリを作成、割り当て、および監視する

基幹業務 (LOB) アプリと同様に、Microsoft Intune に Win32 アプリを追加できます。 この種類のアプリは、通常は社内でまたはサード パーティによって記述されます。 次の手順では、Intune に Windows アプリを追加するためのガイダンスを提供します。

### <a name="step-1-specify-the-software-setup-file"></a>手順 1: ソフトウェアのセットアップ ファイルを指定する

1.  [Azure ポータル](https://portal.azure.com/)にサインインします。
2.  **[すべてのサービス]** > **[Intune]** の順に選択します。 Intune は、**[監視 + 管理]** セクションにあります。
3.  **[Intune]** ウィンドウで、**[クライアント アプリ]** > **[アプリ]** > **[追加]** を選択します。
4.  **[アプリの追加]** ウィンドウで、表示されたドロップダウン リストから **[Windows アプリ (Win32) - プレビュー]** を選択します。

    ![[アプリの追加] - [アプリの種類] ドロップダウン ボックスのスクリーンショット](./media/apps-win32-app-01.png)

### <a name="step-2-upload-the-app-package-file"></a>手順 2: アプリ パッケージ ファイルをアップロードする

1.  **[アプリの追加]** ウィンドウで **[アプリのパッケージ ファイル]** を選択して、ファイルを選択します。 [アプリのパッケージ ファイル] ウィンドウが表示されます。

    ![[アプリのパッケージ ファイル] のスクリーンショット](./media/apps-win32-app-02.png)

2.  **[アプリのパッケージ ファイル]** ウィンドウで、参照ボタンを選択します。 次に、拡張子が *.intunewin* の Windows インストール ファイルを選択します。
3.  完了したら **[OK]** を選択します。

### <a name="step-3-configure-app-information"></a>手順 3: アプリ情報を構成する

1.  **[アプリの追加]** ウィンドウで、**[アプリ情報]** を選び、アプリを構成します。
2.  **[アプリ情報]** ウィンドウで、以下の情報を構成します。 このウィンドウの一部の値は、自動的に入力される場合があります。
    - **[名前]**: アプリの名前を入力します。この名前は会社のポータルに表示されます。 同じアプリ名が 2 つ存在する場合、各アプリがポータル サイトに表示されます。
    - **[説明]**: アプリの説明を入力します。 説明はポータル サイトに表示されます。
    - **[発行元]**: アプリの発行元の名前を入力します。
    - **[カテゴリ]**: 1 つまたは複数の組み込みアプリ カテゴリを選択するか、作成したカテゴリを選択します。 カテゴリを使用すれば、ユーザーはポータル サイトを参照する際にアプリを見つけやすくなります。
    - **[会社のポータルでおすすめアプリとして表示します]**: ユーザーがアプリを参照する際に、ポータル サイトのメイン ページでアプリを目立つように表示します。
    - **[情報 URL]**: 必要に応じて、このアプリに関する情報が含まれる Web サイトの URL を入力します。 この URL はポータル サイトに表示されます。
    - **[プライバシー URL]**: 必要に応じて、このアプリのプライバシー情報が含まれる Web サイトの URL を入力します。 この URL はポータル サイトに表示されます。
    - **[開発者]**: 必要に応じて、アプリ開発者の名前を入力します。
    - **[所有者]**: 必要に応じて、このアプリの所有者の名前を入力します。 たとえば、「**人事部**」と入力します。
    - **[メモ]**: このアプリに関連付けるメモを入力します。
    - **[ロゴ]**: アプリに関連付けるアイコンをアップロードします。 ユーザーが会社のポータルを参照するとき、アプリにアイコンが表示されます。
3.  完了したら **[OK]** を選択します。

### <a name="step-4-configure-app-installation-details"></a>ステップ 4: アプリのインストール情報を構成する
1.  **[アプリの追加]** ウィンドウで **[プログラム]** を選択して、アプリに対してアプリのインストールおよび削除コマンドを構成します。
2.  アプリをインストールする完全なインストール コマンド ラインを追加します。 

    たとえば、アプリのファイル名が **MyApp123** の場合、`msiexec /i “MyApp123.msi”` を追加します。

3.  アプリの GUID に基づいてアプリをアンインストールする完全なアンインストール コマンド ラインを追加します。 

    例: `msiexec /x “{12345A67-89B0-1234-5678-000001000000}”`

    > [!NOTE]
    > Win32 アプリは、**ユーザー** コンテキストまたは**システム** コンテキストでインストールされるように構成できます。 **ユーザー** コンテキストでは、特定のユーザーのみが参照されます。 **システム** コンテキストでは、Windows 10 デバイスのすべてのユーザーが参照されます。
    >
    > エンド ユーザーは、Win32 アプリをインストールするためにデバイスにログインする必要はありません。

4.  完了したら **[OK]** を選択します。

### <a name="step-5-configure-app-requirements"></a>手順 5: アプリ要件を構成する

1.  **[アプリの追加]** ウィンドウで **[要件]** を選択して、アプリのインストール前にデバイスが満たす必要のある要件を構成します。
2.  **[要件]** ウィンドウで、以下の情報を構成します。 このウィンドウの一部の値は、自動的に入力される場合があります。
    - **[オペレーティング システムのアーキテクチャ]**: アプリをインストールするために必要なアーキテクチャを選択します。
    - **[最低限のオペレーティング システム]**: アプリをインストールするために必要な最低限のオペレーティング システムを選択します。
    - **必要なディスク領域 (MB)**: 必要に応じて、アプリをインストールするためにシステム ドライブで必要な空きディスク領域を追加します。
    - **必要な物理メモリ (MB)**: 必要に応じて、アプリをインストールするために必要な物理メモリ (RAM) を追加します。
    - **[Minimum number of logical processors required]\(必要な論理プロセッサの最小数\)**: 必要に応じて、アプリをインストールするために必要な論理プロセッサの最小数を追加します。
    - **[必要な最小 CPU 速度 (MHz)]**: 必要に応じて、アプリをインストールするために必要な最小 CPU 速度を追加します。
3.  完了したら **[OK]** を選択します。

### <a name="step-6-configure-app-detection-rules"></a>手順 6: アプリの検出規則を構成する

1.  **[アプリの追加]** ウィンドウで **[検出規則]** を選択して、アプリの存在を検出する規則を構成します。
2.  **[規則の形式]** フィールドで、アプリの存在を検出する方法を選択します。 検出規則を手動で構成するか、またはカスタム スクリプトを使用してアプリの存在を検出することができます。 少なくとも 1 つの検出規則を選択する必要があります。 

    > [!NOTE]
    > **[検出規則]** ウィンドウで、複数の規則を選択して追加できます。 アプリを検出するには、**すべての**規則の条件を満たす必要があります。

    - **[検出規則を手動で構成する]** - 次の規則の種類のいずれかを選択できます。
        1.  **[MSI]** – MSI のバージョンの確認に基づいて確認を行います。 このオプションは一度だけ追加できます。 この規則の種類を選択すると、次の 2 つの設定が表示されます。
            - **[MSI 製品コード]** – アプリの有効な MSI 製品コードを追加します。
            - **[MSI 製品のバージョンの確認]** – **[はい]** を選択すると、MSI 製品コードに加えて MSI 製品のバージョンを確認できます。
        2.  **[ファイル]** – ファイルまたはフォルダーの検出、日付、バージョン、またはサイズに基づいて確認を行います。
            - **[パス]** – 検出するファイルまたはフォルダーが含まれるフォルダーの完全なパス。
            - **[ファイル名またはフォルダー名]** - 検出するファイルまたはフォルダー。
            - **[検出方法]** – アプリの存在を確認するために使用する検出方法の種類を選択します。
            - **[Associated with a 32-bit app on 64-bit clients]\(64 ビット クライアントの 32 ビット アプリに関連している\)** - **[はい]** を選択すると、64 ビット クライアントの 32 ビットのコンテキストで任意のパス環境変数が展開されます。 **[いいえ]** (既定) を選択すると、64 ビット クライアントの 64 ビットのコンテキストで任意のパス変数が展開されます。 32 ビット クライアントは、常に 32 ビットのコンテキストを使用します。
            
            **ファイル ベースの検出の例**
            1.  ファイルが存在するかどうかを確認します。
         
                ![[検出規則] ウィンドウ - ファイルの存在を確認する場合のスクリーンショット](./media/apps-win32-app-03.png)
        
            2.  フォルダーが存在するかどうかを確認します。
         
                ![[検出規則] ウィンドウ - フォルダーの存在を確認する場合のスクリーンショット](./media/apps-win32-app-04.png)
        
        3. **[レジストリ]** – 値、文字列、整数、またはバージョンに基づいて確認を行います。
            - **[キーのパス]** – 検出する値を含むレジストリ エントリの完全なパス。
            - **[値の名前]** - 検出するレジストリ値の名前。 この値が空の場合、検出はキーで実行されます。 検出方法がファイルまたはフォルダーの存在の確認以外である場合は、キーの (既定) 値が検出値として使用されます。
            - **[検出方法]** – アプリの存在を確認するために使用する検出方法の種類を選択します。
            - **[Associated with a 32-bit app on 64-bit clients]\(64 ビット クライアントの 32 ビット アプリに関連している\)** - **[はい]** を選択すると、64 ビット クライアントで 32 ビットのレジストリが検索されます。 **[いいえ]** (既定) を選択すると、64 ビット クライアントで 64 ビットのレジストリが検索されます。 32 ビット クライアントは、常に 32 ビットのレジストリを検索します。
            
            **レジストリ ベースの検出の例**
            1.  レジストリ キーが存在するかどうかを確認します。
            
                ![[検出規則] ウィンドウ - レジストリ キーの存在を確認する場合のスクリーンショット](./media/apps-win32-app-05.png)    
            
            2.  レジストリ値が存在するかどうかを確認します (**プレビューでは使用できません**)。
        
                ![[検出規則] ウィンドウ - レジストリ値の存在を確認する場合のスクリーンショット](./media/apps-win32-app-06.png)    
        
            3.  レジストリ値の文字列が等しいかどうかを確認します。
        
                ![[検出規則] ウィンドウ - レジストリ値の文字列が等しいかどうかを確認する場合のスクリーンショット](./media/apps-win32-app-07.png)    
     
    - **[Use a custom detection script]\(カスタムの検出スクリプトを使用する\)** – このアプリを検出するために使用する PowerShell スクリプトを指定します。 
    
        1.  **[スクリプト ファイル]** – クライアントでアプリの存在を検出する PowerShell スクリプトを選択します。 スクリプトが値 0 の終了コードを返し、さらに STDOUT に文字列値を書き込むと、アプリが検出されます。
        2.  **[64 ビット クライアントで 32 ビット プロセスとしてスクリプトを実行する]** - **[はい]** を選択すると、ログオンしているエンド ユーザーの資格情報を使用してスクリプトが実行されます。 **[いいえ]** (既定) を選択すると、システム コンテキストでスクリプトが実行されます。
        3.  **[スクリプト署名チェックを強制]** - **[はい]** を選択すると、信頼された発行元によってスクリプトが署名されていることを確認できます。これにより、警告もプロンプトも表示されることなくスクリプトを実行できます。 スクリプトはブロックされずに実行されます。 **[いいえ]** (既定) を選択すると、署名の確認なしに、エンド ユーザーの確認を使用してスクリプトが実行されます。
    
        Intune サイドバーでは、スクリプトの結果を調べます。 スクリプトによって標準出力 (STDOUT) ストリーム、標準エラー (STDERR) ストリーム、および終了コードに書き込まれた値を読み取ります。 スクリプトがゼロではない値で終了した場合、スクリプトは失敗しており、アプリケーション検出の状態は "未インストール" になります。 終了コードがゼロで、STDOUT にデータがある場合、アプリケーション検出状態は "インストール済み" になります。 
    
        > [!NOTE]
        > スクリプトが値 0 で終了した場合、スクリプトの実行は成功しました。 2 番目の出力チャネルは、アプリが検出されたことを示します。STDOUT データは、クライアントでアプリが見つかったことを示します。 STDOUT から特定の文字列を検索することはありません。
    
3.  規則を追加したら、**[追加]** > **[OK]** を選択します。

### <a name="step-7-configure-app-return-codes"></a>手順 7: アプリのリターン コードを構成する

1.  **[アプリの追加]** ウィンドウで **[リターン コード]** を選択して、アプリのインストールの再試行動作またはインストール後の動作のいずれかを指定するのに使用するリターン コードを追加します。 リターン コードのエントリは、アプリの作成時に既定で追加されます。 ただし、リターン コードをさらに追加したり、既存のリターン コードを変更したりできます。 
2.  **[リターン コード]** ウィンドウで、リターン コードをさらに追加するか、または既存のリターン コードを変更します。
    - **[失敗]** – アプリのインストールの失敗を示す戻り値。
    - **[ハード リブート]** – ハード リブートのリターン コードでは、再起動なしにクライアントに次の Win32 アプリをインストールすることはできません。 
    - **[ソフト リブート]** – ソフト リブートのリターン コードでは、クライアントを再起動しなくても次の Win32 アプリをインストールできます。 は、現在のアプリケーションのインストールを完了するには、再起動する必要があります。
    - **[再試行]** – 再試行のリターン コードのエージェントは、アプリのインストールを 3 回試行します。 各試行の間に 5 分間待機します。 
    - **[成功]** – アプリが正常にインストールされたことを示す戻り値。
3.  リターン コードのリストを追加または変更したら、**[OK]** をクリックします。

### <a name="step-8-add-the-app"></a>手順 8: アプリを追加する

1.  **[アプリの追加]** ウィンドウで、アプリ情報を正しく構成したことを確認します。
2.  **[追加]** を選択して、アプリを Intune にアップロードします。

### <a name="step-9-assign-the-app"></a>手順 9: アプリを割り当てる

1.  アプリ ウィンドウで、**[割り当て]** を選択します。
2.  **[グループの追加]** を選んで、アプリに関連する **[グループの追加]** ウィンドウを開きます。
3.  特定のアプリについて、**[割り当ての種類]** を選びます。
    - **[登録済みデバイスで使用可能]**: ユーザーはアプリをポータル サイト アプリまたはポータル Web サイトからインストールできます。
    - **[必須]**: アプリは選択したグループのデバイスにインストールされます。
    - **[アンインストール]**: アプリは選択したグループのデバイスからアンインストールされます。
4.  **[組み込まれたグループ]** を選択し、このアプリを使用するグループを割り当てます。
5.  **[割り当て]** ウィンドウで **[OK]** を選んで含めるグループの選択を完了します。
6.  このアプリ割り当ての影響から除外するユーザー グループがある場合は、**[除外されたグループ]** を選びます。
7.  **[グループの追加]** ウィンドウで **[OK]** を選択します。
8.  アプリの **[割り当て]** ウィンドウで、**[保存]** を選びます。

この時点で、Intune に Win32 アプリを追加する手順が完了しました。 アプリの割り当てと監視については、「[Microsoft Intune を使用してアプリをグループに割り当てる](https://docs.microsoft.com/intune/apps-deploy)」および「[Microsoft Intune でアプリの情報と割り当てを監視する](https://docs.microsoft.com/intune/apps-monitor)」を参照してください。

## <a name="install-required-and-available-apps-on-devices"></a>デバイスに必須および利用可能なアプリをインストールする

エンド ユーザーに対して、必須および利用可能なアプリのインストールのための Windows トースト通知が表示されます。 次の図は、デバイスが再起動されるまでアプリのインストールが完了しない、トースト通知の例を示します。 

![アプリのインストールのための Windows トースト通知のスクリーンショット例](./media/apps-win32-app-08.png)    

次の図では、デバイスに対してアプリの変更が行われていることがエンド ユーザーに通知されます。

![デバイスに対してアプリの変更が行われていることがエンド ユーザーに通知される際のスクリーンショット例](./media/apps-win32-app-09.png)    

## <a name="troubleshoot-win32-app-issues"></a>Win32 アプリの問題をトラブルシューティングする
クライアント コンピューター上のエージェント ログは、一般的に `C:\ProgramData\Microsoft\IntuneManagementExtension\Logs` にあります。 これらのログ ファイルを表示するには、`CMTrace.exe` を利用します。 *CMTrace.exe* は、[SCCM クライアント ツール](https://docs.microsoft.com/sccm/core/support/tools)からダウンロードできます。 

![エージェント ログのスクリーンショット](./media/apps-win32-app-10.png)    

### <a name="troubleshooting-areas-to-consider"></a>検討すべきトラブルシューティング領域
- ターゲットを確認して、デバイスにエージェントがインストールされていることを確認する - グループをターゲットとする Win32 アプリ、またはグループをターゲットとする PowerShell スクリプトは、セキュリティ グループのエージェントのインストール ポリシーを作成します。
- OS バージョンを確認する – Windows 10 1607 以降である必要があります。  
- Windows 10 SKU を確認する - Windows 10 S (S モードを有効にして実行されている Windows バージョン) では、MSI のインストールはサポートされていません。

## <a name="next-steps"></a>次の手順

- Intune にアプリを追加する方法の詳細については、「[Microsoft Intune にアプリを追加する](apps-add.md)」を参照してください。
